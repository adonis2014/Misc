import json

READ_ONLY = 'READ_ONLY'
READ_WRITE = 'READ_WRITE'
new_ro = [3460,3362,3482,2612,2769,3503,3007,3131,3524,2443,3543,2734,2814,3273,3408,2671,3063,3262,3525,2747,3179,2519,3219,3141,3066,3492,2630,2949,3162,2635,2808,2838,2791,2744,2892,3077,3065,2794,2494,3415,2933,3176,4655,2446,3354,4617,3107,4529,4513,3172,2604,2672,2542,4643,3449,3336,3177,3561,2885,3322,3079,3454,3112,3412,4555,4579,4657,4641,4659,3341,4543,4557,4511,2909,3447,2639,4565,3027,4541,4545,4575,4629,4619,4515,4525,4581,4571,3325,4593,4489,4549,4521,4553,4589,4597,2761,4635,3505,4595,4519,2684,3382,4649,4623,4615,4577,4277,3033,4491,4625,3247,2445,4547,4373,2504,4627,4601,4613,4651,3480,3150,4621,4457,4537,4583,4561,4397,2448,4305,2549,2735,4497,4633,2780,4607,4365,4639,4509,2891,2998,3174,4551,4559,4507,4495,3316,3212,3996,2694,4505,2810,2932,4449,4503,3153,2692,4539,3484,3142,4585,2596,4313,3387,2704,4485,4487,4245,4533,4645,4501,4647,4329,2771,4603,3558,2979,4605,4637,4176,4587,4269,4567,2942,4337,3092,4527,4569,4631,3097,4535,4609,2462,4523,2474,4493,3357,4517,4573,2966,2958,2678,2915,4531,3349,4653,4599,2886,2631,4611,2967,3508,3407,3425,3080,3203,4168,4389,4433,2587,3472,2839,4164,3522,4253,3343,2807,2715,3414,4563,3442,4108,2733,2609,3248,2546,4116,4425,2578,2659,3138,4044,3082,3383,4499,3535,3099,3390,4591,2849,2498,2716,2738,2996,2470,2722,3542,3221,2485,4056,4104,3190,2466,3100,2858,2653,2934,3042,3251,2664,4048,3046,3988,3128,3268,3016,3338,3012,2539,2803,2714,3193,3090,3529,3313,2927,2776,3225,2901,2685,2856,2703,2795,2868,2569,2706,3321,3186,3183,3103,3135,2679,2852,3399,2993,2487,2889,3468,3359,3133,2741,3444,3216,3113,3163,3441,2767,3269,2984,3237,2490,2586,2903,3129,2700,3339,2574,2859,2696,2758,3380,3512,2575,2506,2957,2670,2827,2652,3347,2821,3120,3106,2623,2775,3504,2736,3003,3185,3379,3181,2978,2660,3165,2830,3495,3527,3266,2457,3320,3287,2943,2605,3164,2850,3303,3515,3307,3274,3305,3061,3485,3483,3228,2662,3157,2673,3300,3252,2913,3122,3409,2541,3360,3132,2823,2837,2537,3202,2643,3004,3109,2680,2894,3211,2591,3502,2480,3229,3272,2538,3528,3463,2518,3418,2473,2843,2478,2994,2954,3314,2675,2564,2455,2649,2869,3146,3000,3431,2895,2510,2567,2969,3456,3334,3391,2617,2556,2563,3378,2806,3406,2755,3123,3494,2959,2991,3394,2844,2819,3096,2529,3311,2960,3224,3346,3478,3116,3366,3395,2669,3396,2683,2712,2939,3556,2725,3156,3256,2479,3227,3022,2853,3291,3032,2812,3289,3471,3244,2638,2911,2893,2526,2717,2983,3464,2513,2762,2463,2872,2508,2940,3052,2729,2615,3159,2584,3348,2484,3049,3276,2534,3326,3559,3401,3554,3416,3001,3170,2813,3278,3518,2681,2610,2965,2876,3260,3010,2908,3037,2772,3538,2461,3145,2611,3199,3070,2904,2619,3013,3521,3548,2651,2711,3180,2925,2731,3265,3067,3317,2985,3353,3189,2798,2781,2766,3198,3368,3516,3498,3062,2559,2753,2502,2963,3371,2535,2453,3127,3233,3533,3111,3469,2702,2710,3448,3487,2656,2999,3043,2818,3115,3421,3064,3430,3035,2552,3068,3560,3243,3470,2864,3169,3461,3069,3151,2964,2796,3417,2961,3025,3551,2633,2902,2536,2471,2890,2835,2851,2947,2451,2727,3514,3161,3438,3166,3332,3550,2763,3057,3327,2774,2523,2585,3026,3204,3036,3101,2748,2921,3154,2486,3288,2935,3342,3344,2873,3048,2916,2870,2857,2931,2953,2828,3436,3446,3440,3547,2822,3254,3108,2558,3534,2955,3041,2618,2910,2792,2522,2687,3282,2548,2454,3511,3509,3245,3140,2628,3318,2607,3506,3337,2866,2565,3496,3232,2777,2840,2756,3182,2862,2977,3019,3253,3009,3014,3433,2481,3467,3194,2581,3432,3286,2557,3195,2922,2709,3121,2648,3545,2746,2515,3095,2588,2597,2825,2739,2572,2632,3363,3304,3038,3158,2554,3231,3350,2740,3093,3434,2980,3429,3388,2667,2476,2640,2846,2467,2595,3275,2824,3255,3230,2459,3984,2917,2929,4387,4275,4307,4283,4455,4451,4379,4100,3944,4359,4479,4395,4271,4120,4263,4351,4227,4319,3964,4180,4016,4247,4463,4060,4407,4403,4076,4335,4331,4367,4287,4411,4355,4471,4156,4311,4475,4427,4347,4239,3976,4343,4132,4036,4267,4447,4299,4190,4439,3956,4096,4371,4443,4415,3960,4467,4196,4000,4251,4431,4140,4327,4204,4435,4220,4212,4144,4323,4032,4259,4080,4315,3972,4383,4024,4216,4391,4040,4295,4020,4375,4012,4291,4419,4255,2691,4235,4124,3950,4198,3980,4136,4192,4018,4092,4084,4184,4160,4004,3952,4078,4070,4064,4152,4010,3958,4200,4130,4072,4138,4231,4086,4146,3966,4026,4206,3375,2530,3021,4243,4303,4483,2688,4423,3301,3240,3105,2464,4357,4363,2784,3392,2576,4413,4417,4353,4477,2845,4233,2816,4421,3330,4241,4481,3257,4473,4297,4361,4237,4006,4065,3977,4293,2686,3953,2625,4150,4089,4157,4193,3536,4005,4301,4037,3946,4098,3962,2514,3059,2488,2948,2698,4209,2642,3267,2896,2547,3376,2614,3404,3477,3167,3281,3358,2751,2570,3497,4097,3530,2705,2697,3242,2495,2726,3104,2863,2906,3473,2829,3323,3024,3413,2968,4066,3139,2854,2789,3427,3540,3308,3050,2938,2620,3491,3017,3258,4210,3397,3020,3196,2645,3386,4158,4149,2460,3222,3143,2690,2465,4029,4142,4073,4030,3970,3978,3361,2550,4013,2444,3372,4202,3455,4218,3299,2627,3152,2787,4126,4090,4038,3969,4133,4185,4186,4022,4217,2720,3552,4082,3008,2842,4223,3945,4125,2573,4127,3168,3983,3951,4187,4404,4043,3975,4011,4023,4356,4344,4151,3544,4284,2972,4203,3967,3959,4103,4131,4211,3955,3034,4135,4207,4416,3971,4163,4031,4348,4476,4143,3963,4071,4215,2848,4019,4296,4079,4139,2509,2528,4147,4236,4091,4075,4195,4035,4067,3947,4199,4468]
new_rw = []

def get_partition_map(partitions):
    mapping = dict()
    for partition in partitions:
        mapping[partition['id']] = partition['partitionState'] 
    return mapping

with open('PartitionLayoutProdOld.json', 'r') as f:
    old = get_partition_map(json.load(f)['partitions'])

with open('PartitionLayoutProd.json', 'r') as f:
    new = get_partition_map(json.load(f)['partitions'])

if len(old) != len(new):
    print('There is a mismatch in the number of partitions !')

new_ro_count = 0
new_rw_count = 0
old_ro_count = 0
old_rw_count = 0
for p_id,p_state in old.iteritems():
    new_p_state = new[p_id]
    if p_id in new_ro:
        if new_p_state != READ_ONLY:
            print(str(p_id) + ' should be RO!')
    elif p_id in new_rw:
        if new_p_state != READ_WRITE:
            print(str(p_id) + ' should be RW!')
    elif p_state != new_p_state:
        print('Writablity of ' + str(p_id) + ' should not have changed to ' + new_p_state + '!')

    if p_state == READ_ONLY:
        old_ro_count += 1
    elif p_state == READ_WRITE:
        old_rw_count += 1

    if new_p_state == READ_ONLY:
        new_ro_count += 1
    elif new_p_state == READ_WRITE:
        new_rw_count += 1

print('Total partitions: ' + str(len(new)))
print('RW in old: ' + str(old_rw_count))
print('RO in old: ' + str(old_ro_count))
print('RW in new: ' + str(new_rw_count))
print('RO in new: ' + str(new_ro_count))
